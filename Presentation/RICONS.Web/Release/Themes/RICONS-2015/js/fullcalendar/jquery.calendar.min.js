(function(n){var u=[i18n.xgcalendar.dateformat.sun,i18n.xgcalendar.dateformat.mon,i18n.xgcalendar.dateformat.tue,i18n.xgcalendar.dateformat.wed,i18n.xgcalendar.dateformat.thu,i18n.xgcalendar.dateformat.fri,i18n.xgcalendar.dateformat.sat],e=[i18n.xgcalendar.dateformat.jan,i18n.xgcalendar.dateformat.feb,i18n.xgcalendar.dateformat.mar,i18n.xgcalendar.dateformat.apr,i18n.xgcalendar.dateformat.may,i18n.xgcalendar.dateformat.jun,i18n.xgcalendar.dateformat.jul,i18n.xgcalendar.dateformat.aug,i18n.xgcalendar.dateformat.sep,i18n.xgcalendar.dateformat.oct,i18n.xgcalendar.dateformat.nov,i18n.xgcalendar.dateformat.dec],f,t,i,r;f&&typeof f=="function"||(f=function(n){var i={},t;i=n.constructor==Object?new n.constructor:new n.constructor(n.valueOf());for(t in n)i[t]!=n[t]&&(i[t]=typeof n[t]=="object"?f(n[t]):n[t]);return i.toString=n.toString,i.valueOf=n.valueOf,i});t&&typeof t=="function"||(t=function(n){var i={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),w:"0123456".indexOf(this.getDay()),W:u[this.getDay()],L:e[this.getMonth()]},t;/(y+)/.test(n)&&(n=n.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(t in i)new RegExp("("+t+")").test(n)&&(n=n.replace(RegExp.$1,RegExp.$1.length==1?i[t]:("00"+i[t]).substr((""+i[t]).length)));return n});i&&typeof r=="function"||(i=function(interval,number,idate){number=parseInt(number);var date;typeof idate=="string"&&(date=idate.split(/\D/),eval("var date = new Date("+date.join(",")+")"));typeof idate=="object"&&(date=new Date(idate.toString()));switch(interval){case"y":date.setFullYear(date.getFullYear()+number);break;case"m":date.setMonth(date.getMonth()+number);break;case"d":date.setDate(date.getDate()+number);break;case"w":date.setDate(date.getDate()+7*number);break;case"h":date.setHours(date.getHours()+number);break;case"n":date.setMinutes(date.getMinutes()+number);break;case"s":date.setSeconds(date.getSeconds()+number);break;case"l":date.setMilliseconds(date.getMilliseconds()+number)}return date});r&&typeof r=="function"||(r=function(n,t,i){switch(n){case"d":case"w":t=new Date(t.getFullYear(),t.getMonth(),t.getDate());i=new Date(i.getFullYear(),i.getMonth(),i.getDate());break;case"h":t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours());i=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours());break;case"n":t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes());i=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes());break;case"s":t=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());i=new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds())}var u=t.getTime(),f=i.getTime(),r=NaN;switch(n){case"y":r=i.getFullYear()-t.getFullYear();break;case"m":r=(i.getFullYear()-t.getFullYear())*12+i.getMonth()-t.getMonth();break;case"d":r=Math.floor(f/864e5)-Math.floor(u/864e5);break;case"w":r=Math.floor((f+3456e5)/6048e5)-Math.floor((u+3456e5)/6048e5);break;case"h":r=Math.floor(f/36e5)-Math.floor(u/36e5);break;case"n":r=Math.floor(f/6e4)-Math.floor(u/6e4);break;case"s":r=Math.floor(f/1e3)-Math.floor(u/1e3);break;case"l":r=f-u}return r});n.fn.noSelect==undefined&&(n.fn.noSelect=function(t){return prevent=t==null?!0:t,prevent?this.each(function(){n.browser.msie||n.browser.safari?n(this).bind("selectstart",function(){return!1}):n.browser.mozilla?(n(this).css("MozUserSelect","none"),n("body").trigger("focus")):n.browser.opera?n(this).bind("mousedown",function(){return!1}):n(this).attr("unselectable","on")}):this.each(function(){n.browser.msie||n.browser.safari?n(this).unbind("selectstart"):n.browser.mozilla?n(this).css("MozUserSelect","inherit"):n.browser.opera?n(this).unbind("mousedown"):n(this).removeAttr("unselectable","on")})});n.fn.bcalendar=function(e){function bt(){h.empty()}function kt(){return{start:e.vstart,end:e.vend}}function dt(n,t){var f=e.loadDateR.length,u,h,o,c,i;if(t||(t=n),f==0)e.loadDateR.push({startdate:n,enddate:t});else{for(i=0;i<f;i++)if(u=e.loadDateR[i],h=r("d",n,u.startdate),h==0||h==1){u.enddate<t&&(u.enddate=t);break}else if(h>1){o=r("d",t,u.startdate);o>1?e.loadDateR.splice(0,0,{startdate:n,enddate:t}):(u.startdate=n,u.enddate<t&&(u.enddate=t));break}else if(c=r("d",t,u.startdate),u.enddate<t)if(c<1){u.enddate=t;break}else i==f-1&&e.loadDateR.push({startdate:n,enddate:t});if(f=e.loadDateR.length,f>1)for(i=0;i<f-1;){var s=e.loadDateR[i],o=e.loadDateR[i+1],l=r("d",o.startdate,s.enddate);if(l<=1){s.startdate=o.startdate>s.startdate?s.startdate:o.startdate;s.enddate=o.enddate>s.enddate?o.enddate:s.enddate;e.loadDateR.splice(i+1,1);f--;continue}i++}}}function o(){var t=new Date(e.showday.getFullYear(),e.showday.getMonth(),e.showday.getDate()),i=e.eventItems,r={view:e.view,weekstartday:e.weekstartday,theme:e.theme},u;(e.view=="day"||e.view=="week")&&(u=n("#dvtec"),u.length>0&&(e.scoll=u.attr("scrollTop")));switch(e.view){case"day":gt(t,1,i,r);break;case"week":gt(t,7,i,r);break;case"month":yi(t,i,r);break;default:alert(i18n.xgcalendar.no_implement)}ar(e.view);lr()}function gt(n,r,u,f){var o=[],c,l,v,y,a;if(r==1)a=t.call(n,i18n.xgcalendar.dateformat.Md),o.push({display:a,date:n,day:n.getDate(),year:n.getFullYear(),month:n.getMonth()+1}),e.datestrshow=ft(o[0].date),e.vstart=o[0].date,e.vend=o[0].date;else{for(c=0,r==7&&(c=f.weekstartday-n.getDay(),c>0&&(c=c-7)),v=c,y=0;y<r;v=v+1,y++)l=i("d",v,n),a=t.call(l,i18n.xgcalendar.dateformat.Md),o.push({display:a,date:l,day:l.getDate(),year:l.getFullYear(),month:l.getMonth()+1});e.vstart=o[0].date;e.vend=o[r-1].date;e.datestrshow=ft(o[0].date,o[r-1].date)}var p=[],w=[],b=pi(o,u,p,w),s=[];s.push('<div id="dvwkcontaienr" class="wktopcontainer">');s.push('<table class="wk-top" border="0" cellpadding="0" cellspacing="0">');wi(s,o,p,b);s.push("<\/table>");s.push("<\/div>");s.push('<div id="dvtec"  class="scolltimeevent"><table style="table-layout: fixed;',jQuery.browser.msie?"":"width:100%",'" cellspacing="0" cellpadding="0"><tbody><tr><td>');s.push('<table style="height: 1008px" id="tgTable" class="tg-timedevents" cellspacing="0" cellpadding="0"><tbody>');bi(s,o,w);s.push("<\/tbody><\/table><\/td><\/tr><\/tbody><\/table><\/div>");h.html(s.join(""));s=null}function yi(t,i,r){var f=[],e,o,c,s;for(f.push("<div id='cal-month-cc' class='cc'><div id='cal-month-cc-header'><div class='cc-close' id='cal-month-closebtn'><\/div><div id='cal-month-cc-title' class='cc-title'><\/div><\/div><div id='cal-month-cc-body' class='cc-body'><div id='cal-month-cc-content' class='st-contents'><table class='st-grid' cellSpacing='0' cellPadding='0'><tbody><\/tbody><\/table><\/div><\/div><\/div>"),f.push('<div id="mvcontainer" class="mv-container">'),f.push('<table id="mvweek" class="mv-daynames-table" cellSpacing="0" cellPadding="0"><tbody><tr>'),e=r.weekstartday,o=0;o<7;e++,o++)e>6&&(e=0),c={dayname:u[e]},f.push('<th class="mv-dayname" title="',u[e],'">',u[e],"");f.push("<\/tr><\/tbody><\/table>");f.push("<\/div>");s=gi()-nr();f.push('<div id="mvEventContainer" class="mv-event-container" style="height:',s,"px;",'">');tr(f,t,r.weekstartday,i,s);f.push("<\/div>");h.html(f.join(""));f=null;n("#cal-month-closebtn").click(ni)}function ni(){n("#cal-month-cc").css("visibility","hidden")}function pi(n,t,i,u){for(var it,p,rt,ot,h,l,c,k,w,ut,s,v,e,y,b,ft,g=n.length,st=t.length,a=[],nt=i,tt=u,f=0;f<st;f++){var d=t[f][2],et=t[f][3],o={};o.event=t[f];o.day=d.getDate();o.year=d.getFullYear();o.month=d.getMonth()+1;o.allday=t[f][4]==1;o.crossday=t[f][5]==1;o.reevent=t[f][6]==1;o.daystr=[o.year,o.month,o.day].join("/");o.st={};o.st.hour=d.getHours();o.st.minute=d.getMinutes();o.st.p=o.st.hour*60+o.st.minute;o.et={};o.et.hour=et.getHours();o.et.minute=et.getMinutes();o.et.p=o.et.hour*60+o.et.minute;a.push(o)}for(it=0,h=0;h<g;h++)for(p=n[h],tt[h]=[],nt[h]=[],p.daystr=p.year+"/"+p.month+"/"+p.day,f=0;f<a.length;f++)a[f].crossday||a[f].allday?p.daystr==a[f].daystr?(nt[h].push(a[f]),it++):h==0&&p.date>=a[f].event[2]&&p.date<=a[f].event[3]&&(nt[h].push(a[f]),it++):p.daystr==a[f].daystr&&tt[h].push(a[f]);for(rt=n[g-1].date,h=0;h<g;h++){if(l=nt[h],l.length>0)for(f=0;f<l.length;f++)ot=r("d",rt,l[f].event[3])>0?rt:l[f].event[3],l[f].colSpan=r("d",n[h].date,ot)+1;l=null}for(h=0;h<g;h++)if(l=tt[h],l.length>0){var e=[],v=[],y=[],ht=l.length,s;for(f=0;f<ht;++f){for(c=l[f],k=c.st.p,s=0;v[s]>k;)s++;for(c.PO=s,c.ne=[],v[s]=c.et.p||1440,e[s]=c,y[s]||(y[s]=[]),y[s].push(c),s!=0&&(c.pe=[e[s-1]],e[s-1].ne.push(c)),s=s+1;v[s]<=k;)s++;e[s]&&(w=e[s],c.ne.push(w),w.pe.push(c));c.width=1/(c.PO+1);c.left=1-c.width}for(w=Array.prototype.concat.apply([],y),e=v=y=null,ut=w.length,v=ut;v--;){var b=1,k=0,e=w[v];for(y=e.ne.length;y--;)s=e.ne[y],k=Math.max(k,s.VL),b=Math.min(b,s.left);e.VL=k+1;e.width=b/(e.PO+1);e.left=b-e.width}for(v=0;v<ut;v++){if(e=w[v],e.left=0,e.pe)for(y=e.pe.length;y--;)b=e.pe[y],e.left=Math.max(e.left,b.left+b.width);ft=(1-e.left)/e.VL;e.width=Math.max(e.width,ft);e.aQ=Math.min(1-e.left,e.width+.7*ft)}l=null;tt[h]=w}return it}function wi(n,i,r,u){var l,a,v,e,s,o,y,f;for(n.push("<tr>",'<th width="60" rowspan="3">&nbsp;<\/th>'),e=0;e<i.length;e++)i.length==1?(l="",a="",v=""):(l="",a=i18n.xgcalendar.to_date_view,v="wk-daylink"),n.push("<th abbr='",t.call(i[e].date,i18n.xgcalendar.dateformat.fulldayvalue),"' class='gcweekname' scope=\"col\"><div title='",a,"' ",l," class='wk-dayname'><span class='",v,"'>",i[e].display,"<\/span><\/div><\/th>");if(n.push('<th width="16" rowspan="3">&nbsp;<\/th>'),n.push("<\/tr>"),n.push("<tr>"),n.push('<td class="wk-allday"'),i.length>1&&n.push(" colSpan='",i.length,"'"),n.push('><div id="weekViewAllDaywk" ><table class="st-grid" cellpadding="0" cellspacing="0"><tbody>'),u==0){for(n.push("<tr>"),e=0;e<i.length;e++)n.push('<td class="st-c st-s"'," ch='qkadd' abbr='",t.call(i[e].date,"yyyy-M-d"),"' axis='00:00'>&nbsp;<\/td>");n.push("<\/tr>")}else{var h=r.length,p=0,c=[];for(s=0;s<h;s++)c.push(0);for(s=0;p<u;s++){for(n.push("<tr>"),f=0;f<h;)o=r[f][c[f]],n.push("<td class='st-c"),o?(c[f]=c[f]+1,n.push("'"),y=lt(o,i[f].date,h-f),o.colSpan>1?(n.push(" colSpan='",o.colSpan,"'"),f+=o.colSpan):f++,n.push(" ch='show'>",y),y=null,p++):(n.push(" st-s' ch='qkadd' abbr='",t.call(i[f].date,i18n.xgcalendar.dateformat.fulldayvalue),"' axis='00:00'>&nbsp;"),f++),n.push("<\/td>");n.push("<\/tr>")}for(n.push("<tr>"),f=0;f<h;f++)n.push("<td class='st-c st-s' ch='qkadd' abbr='",t.call(i[f].date,i18n.xgcalendar.dateformat.fulldayvalue),"' axis='00:00'>&nbsp;<\/td>");n.push("<\/tr>")}n.push("<\/tbody><\/table><\/div><\/td><\/tr>");n.push("<tr>");n.push('<td style="height: 5px;"');i.length>1&&n.push(" colSpan='",i.length,"'");n.push("><\/td>");n.push("<\/tr>")}function bi(n,i,r){var f,h,u,e,c;for(n.push("<tr>"),n.push("<td style='width:60px;'><\/td>"),n.push("<td"),i.length>1&&n.push(" colSpan='",i.length,"'"),n.push('><div id="tgspanningwrapper" class="tg-spanningwrapper"><div style="font-size: 20px" class="tg-hourmarkers">'),u=0;u<24;u++)n.push('<div class="tg-dualmarker"><\/div>');n.push("<\/div><\/div><\/td><\/tr>");n.push("<tr>");n.push('<td style="width: 60px" class="tg-times">');var o=new Date,a=o.getHours(),v=o.getMinutes(),s=l(a,v)-4;for(n.push('<div id="tgnowptr" class="tg-nowptr" style="left:0px;top:',s,'px"><\/div>'),f="",u=0;u<24;u++)f=or(u),n.push('<div style="height: 41px" class="tg-time">',f,"<\/div>");for(n.push("<\/td>"),h=i.length,u=0;u<h;u++)n.push("<td class=\"tg-col\" ch='qkadd' abbr='",t.call(i[u].date,i18n.xgcalendar.dateformat.fulldayvalue),"'>"),e=t.call(i[u].date,"yyyyMMdd")==t.call(new Date,"yyyyMMdd"),e&&n.push('<div style="margin-bottom: -1008px; height:1008px" class="tg-today">&nbsp;<\/div>'),n.push('<div  style="margin-bottom: -1008px; height: 1008px" id=\'tgCol',u,'\' class="tg-col-eventwrapper">'),ki(n,r[u],i[u]),n.push("<\/div>"),n.push('<div class="tg-col-overlaywrapper" id=\'tgOver',u,"'>"),e&&(c=s+4,n.push('<div id="tgnowmarker" class="tg-hourmarker tg-nowmarker" style="left:0px;top:',c,'px"><\/div>')),n.push("<\/div>"),n.push("<\/td>");n.push("<\/tr>")}function ki(n,t){for(var r,u,i=0;i<t.length;i++)r=t[i].event[7]&&t[i].event[7]>=0?w(t[i].event[7]):w(),u=di(r,t[i],i),n.push(u)}function ti(i){var f,e,u,o,s=i[4]!=1,h,c,r;return o=i[1],h=d(i[2],null,s,!0),c=d(i[3],i[2],s,!0),f=t.call(i[2],h)+" - "+t.call(i[3],c),e=i[9]!=undefined&&i[9]!=""?i[9]:i18n.xgcalendar.i_undefined,u=i[10]!=undefined&&i[10]!=""?i[10]:"",r=[],i[4]==1?r.push("["+i18n.xgcalendar.allday_event+"]",n.browser.mozilla?"":"\r\n"):i[5]==1&&r.push("["+i18n.xgcalendar.repeat_event+"]",n.browser.mozilla?"":"\r\n"),r.push(i18n.xgcalendar.time+":",f,n.browser.mozilla?"":"\r\n",i18n.xgcalendar.event+":",o,n.browser.mozilla?"":"\r\n",i18n.xgcalendar.location+":",e),u!=""&&r.push(n.browser.mozilla?"":"\r\n",i18n.xgcalendar.participant+":",u),r.join("")}function di(n,t,i){var r={bdcolor:n[0],bgcolor2:n[0],bgcolor1:n[2],width:"70%",icon:"",title:"",data:""},u,f,o,s;return r.starttime=c(t.st.hour)+":"+c(t.st.minute),r.endtime=c(t.et.hour)+":"+c(t.et.minute),r.content=t.event[1],r.title=ti(t.event),r.data=t.event.join("$"),u=[],u.push('<I class="cic cic-tmr">&nbsp;<\/I>'),t.reevent&&u.push('<I class="cic cic-spcl">&nbsp;<\/I>'),r.icon=u.join(""),f=l(t.st.hour,t.st.minute),o=l(t.et.hour,t.et.minute),r.top=f+"px",r.left=t.left*100+"%",r.width=t.aQ*100+"%",r.height=o-f-4,r.i=i,e.enableDrag&&t.event[8]==1?(r.drag="drag",r.redisplay="block"):(r.drag="",r.redisplay="none"),s=a(wt,r),r=null,s}function gi(){return e.height}function nr(){return 21}function tr(n,r,u,f,o){var ut=new Date(r.getFullYear(),r.getMonth(),1),d=u-ut.getDay(),et=r.getMonth(),g,nt,it,rt,ct,s,lt,at,h,v,c,vt;d>0&&(d-=7);var p=i("d",d,ut),l=i("d",34,p),y=5;l.getFullYear()==r.getFullYear()&&l.getMonth()==r.getMonth()&&l.getDate()<ai[et]&&(l=i("d",7,l),y=6);e.vstart=p;e.vend=l;e.datestrshow=ft(p,l);o=o-18*y;g=o/y;nt=parseInt(g/21);g%21>15&&nt++;var ot=100/y,k=[],st=ir(f,u,7,p,l),tt=[],w=[];for(s=0;s<y;s++){for(it=0,k[s]=b=[],h=0;h<7;h++)rt=i("d",s*7+h,p),w[s*7+h]=rt,ct=t.call(rt,i18n.xgcalendar.dateformat.fulldaykey),b[h]=st[ct],b[h]&&b[h].length>0&&(it+=b[h].length);tt[s]=it}for(ht.data("mvdata",k),s=0;s<y;s++){for(n.push("<div id='mvrow_",s,"' style=\"HEIGHT:",ot,"%; TOP:",ot*s,'%"  class="month-row">'),n.push('<table class="st-bg-table" cellSpacing="0" cellPadding="0"><tbody><tr>'),lt=tt[s],h=0;h<7;h++)c=w[s*7+h],n.push("<td abbr='",t.call(c,i18n.xgcalendar.dateformat.fulldayvalue),"' ch='qkadd' axis='00:00' title=''"),t.call(c,"yyyyMMdd")==t.call(new Date,"yyyyMMdd")?n.push(' class="st-bg st-bg-today">'):n.push(' class="st-bg">'),n.push("&nbsp;<\/td>");for(n.push("<\/tr><\/tbody><\/table>"),n.push('<table class="st-grid" cellpadding="0" cellspacing="0"><tbody>'),n.push("<tr>"),at="<td class=\"st-dtitle${titleClass}\" ch='qkadd' abbr='${abbr}' axis='00:00' title=\"${title}\"><span class='monthdayshow'>${dayshow}<\/span><\/a><\/td>",h=0;h<7;h++)v={titleClass:"",dayshow:""},c=w[s*7+h],t.call(c,"yyyyMMdd")==t.call(new Date,"yyyyMMdd")&&(v.titleClass=" st-dtitle-today"),c.getMonth()!=et&&(v.titleClass=" st-dtitle-nonmonth"),v.title=t.call(c,i18n.xgcalendar.dateformat.fulldayshow),v.dayshow=c.getDate()==1?c.getMonth==0?t.call(c,i18n.xgcalendar.dateformat.fulldayshow):t.call(c,i18n.xgcalendar.dateformat.Md3):c.getDate(),v.abbr=t.call(c,i18n.xgcalendar.dateformat.fulldayvalue),n.push(a(at,v));n.push("<\/tr>");vt=w[s*7];rr(n,k[s],lt,nt,vt);n.push("<\/tbody><\/table>");n.push("<\/div>")}k=tt=w=st=null}function ir(n,u,e,o,s){for(var w,p,y,v={},k=n.length,l=0;l<k;l++){var c=n[l][2],a=n[l][3],d=r("d",c,a),h={};if(h.event=n[l],h.day=c.getDate(),h.year=c.getFullYear(),h.month=c.getMonth()+1,h.allday=n[l][4]==1,h.crossday=n[l][5]==1,h.reevent=n[l][6]==1,h.daystr=h.year+"/"+h.month+"/"+h.day,h.st={},h.st.hour=c.getHours(),h.st.minute=c.getMinutes(),h.st.p=h.st.hour*60+h.st.minute,h.et={},h.et.hour=a.getHours(),h.et.minute=a.getMinutes(),h.et.p=h.et.hour*60+h.et.minute,d>0)for(c<o&&(c=o),a>s&&(a=s),w=u-c.getDay(),w>0&&(w-=e),p=i("d",w,c);p<=a;c=p=i("d",e,p)){var b=f(h),y=t.call(c,i18n.xgcalendar.dateformat.fulldaykey),g=r("d",p,a);v[y]==null&&(v[y]=[]);b.colSpan=g>=e?e-r("d",p,c):r("d",c,a)+1;v[y].push(b);b=null}else y=t.call(n[l][2],i18n.xgcalendar.dateformat.fulldaykey),v[y]==null&&(v[y]=[]),h.colSpan=1,v[y].push(h);h=null}return v}function rr(r,u,f,e,o){for(var tt,g,l,rt,s,it,y,b=[],v=[],c=[],w=[],d=u.length,nt=0,h=0;h<d;h++)b.push(0),v.push(0),c.push(0),w.push(i("d",h,o));for(h=0;h<d;h++)for(tt=u[h]?u[h].length:0,v[h]+=tt,g=0;g<tt;g++)if(l=u[h][g],l&&l.colSpan>1)for(y=1;y<l.colSpan;y++)v[h+y]++;for(rt="<td class='${cssclass}' axis='${axis}' ch='${ch}' abbr='${abbr}' title='${title}' ${otherAttr}>${html}<\/td>",h=0;h<e&&nt<f;h++){for(r.push("<tr>"),s=0;s<d;){var l=u[s]?u[s][b[s]]:undefined,p={"class":"",axis:"",ch:"",title:"",abbr:"",html:"",otherAttr:"",click:"javascript:void(0);"},k=["st-c"];if(l)if(b[s]=b[s]+1,it=!1,c[s]+1==v[s]&&l.colSpan==1&&(it=!0),!it&&h==e-1&&c[s]<v[s])nt++,n.extend(p,{axis:s,ch:"more",abbr:t.call(w[s],i18n.xgcalendar.dateformat.fulldayvalue),html:i18n.xgcalendar.others+(v[s]-c[s])+i18n.xgcalendar.item,click:"javascript:alert('more event');"}),k.push("st-more st-moreul"),s++;else{if(p.html=lt(l,w[s],d-s),p.ch="show",l.colSpan>1){for(p.otherAttr=" colSpan='"+l.colSpan+"'",y=0;y<l.colSpan;y++)c[s+y]=c[s+y]+1;s+=l.colSpan}else c[s]=c[s]+1,s++;nt++}else h==e-1&&c[s]<v[s]&&v[s]>0?(n.extend(p,{axis:s,ch:"more",abbr:t.call(w[s],i18n.xgcalendar.dateformat.fulldayvalue),html:i18n.xgcalendar.others+(v[s]-c[s])+i18n.xgcalendar.item,click:"javascript:alert('more event');"}),k.push("st-more st-moreul"),s++):(n.extend(p,{html:"&nbsp;",ch:"qkadd",axis:"00:00",abbr:t.call(w[s],i18n.xgcalendar.dateformat.fulldayvalue),title:""}),k.push("st-s"),s++);p.cssclass=k.join(" ");k=null;r.push(a(rt,p));p=null}r.push("<\/tr>")}b=v=c=w=null}function lt(n,t,i){var h,u,v,f;h=n.event[7]&&n.event[7]>=0?w(n.event[7]):w();u={color:h[2],title:"",extendClass:"",extendHTML:"",data:""};u.title=ti(n.event);u.id="bbit_cal_event_"+n.event[0];u.eclass=e.enableDrag&&n.event[8]==1?"drag":"cal_"+n.event[0];u.data=n.event.join("$");var o=[],s=n.event[2]<t,l=r("d",t,n.event[3])>=i;return(s||l)&&(s&&(o.push('<div class="st-ad-ml"><\/div>'),u.extendClass="st-ad-mpad "),l&&o.push('<div class="st-ad-mr"><\/div>'),u.extendHTML=o.join("")),v=n.allday||s?n.event[1]:c(n.st.hour)+":"+c(n.st.minute)+" "+n.event[1],f=[],f.push(a('<span style="cursor: pointer">${content}<\/span>',{content:v})),f.push('<I class="cic cic-tmr">&nbsp;<\/I>'),n.reevent&&f.push('<I class="cic cic-rcr">&nbsp;<\/I>'),u.content=f.join(""),a(li,u)}function at(){var u,i,r;if(e.isloading)return!0;if(e.url&&e.url!=""){if(e.isloading=!0,e.onBeforeRequestData&&n.isFunction(e.onBeforeRequestData))e.onBeforeRequestData(1);if(u=(new Date).getTimezoneOffset()/-60,i=[{name:"showdate",value:t.call(e.showday,i18n.xgcalendar.dateformat.fulldayvalue)},{name:"viewtype",value:e.view},{name:"timezone",value:u}],e.extParam)for(r=0;r<e.extParam.length;r++)i[i.length]=e.extParam[r];n.ajax({type:e.method,url:e.url,data:i,dataType:"json",dataFilter:function(n){return n},success:function(t){if(t!=null&&t.error!=null){if(e.onRequestDataError)e.onRequestDataError(1,t)}else t.start=rt(t.start),t.end=rt(t.end),n.each(t.events,function(n,t){t[2]=rt(t[2]);t[3]=rt(t[3])}),ur(t,t.start,t.end),dt(t.start,t.end);if(e.onAfterRequestData&&n.isFunction(e.onAfterRequestData))e.onAfterRequestData(1);e.isloading=!1},error:function(t){try{if(e.onRequestDataError)e.onRequestDataError(1,t);else alert(i18n.xgcalendar.get_data_exception);if(e.onAfterRequestData&&n.isFunction(e.onAfterRequestData))e.onAfterRequestData(1);e.isloading=!1}catch(i){}}})}else alert("url"+i18n.xgcalendar.i_undefined)}function ur(n,t,i){var r;r=n.issort==!1?n.events&&n.events.length>0?n.sort(function(n,t){return n[2]>t[2]?-1:1}):[]:n.events;er(r,t,i);o()}function fr(n,t){var r=n.length,f,o,i,s,u;if(r>0)for(f=n[0][2],o=n[r-1][2],i=0,s=e.eventItems.length;i<s;i++){if(e.eventItems[i][2]>o||r==0)break;if(e.eventItems[i][2]>=f)for(u=0;u<r;u++)if(e.eventItems[i][0]==n[u][0]&&e.eventItems[i][2]<t){n.splice(u,1);r--;break}}}function er(n,t,i){var r,s,h;if(n||(n=[]),n)if(e.eventItems.length==0)e.eventItems=n;else{fr(n,t,i);var a=n.length,u=e.eventItems.length,f=-1,o=u,c=t,l=i;if(e.eventItems[0][2]>l){e.eventItems=n.concat(e.eventItems);return}if(e.eventItems[u-1][2]<c){e.eventItems=e.eventItems.concat(n);return}for(r=0;r<u;r++){if(e.eventItems[r][2]>=c&&f<0){f=r;continue}if(e.eventItems[r][2]>l){o=r;break}}s=f<=0?[]:e.eventItems.slice(0,f);h=o==u?[]:e.eventItems.slice(o);e.eventItems=[].concat(s,n,h);n=s=h=null}}function ii(){var t=n(this),i=t.attr("abbr");if(e.showday=nt(i+" 00:00"),e.view="day",o(),e.onweekormonthtoday)e.onweekormonthtoday(e);return!1}function rt(n){return new Date(Date.parse(n))}function l(n,t){return n*42+parseInt(t/60*42)}function ut(n,t){var i=n/42,r=parseInt(i),e=i-r>=.5?30:0,u=t/42,f=parseInt(u),o=u-f>=.5?30:0;return{sh:r,sm:e,eh:f,em:o,h:t-n}}function ri(n,t,i){var r=Math.min(n,t),u=Math.max(n,t),f=(r-i)/42,e=parseInt(f),h=f-e>=.5?30:0,o=(u-i)/42,s=parseInt(o),c=o-s>=.5?30:0;return{sh:e,sm:h,eh:s,em:c,h:u-r}}function c(n){return n<10?"0"+n:""+n}function w(n){function t(n,t){return"#"+"666666888888aaaaaabbbbbbdddddda32929cc3333d96666e69999f0c2c2b1365fdd4477e67399eea2bbf5c7d67a367a994499b373b3cca2cce1c7e15229a36633cc8c66d9b399e6d1c2f029527a336699668cb399b3ccc2d1e12952a33366cc668cd999b3e6c2d1f01b887a22aa9959bfb391d5ccbde6e128754e32926265ad8999c9b1c2dfd00d78131096184cb05288cb8cb8e0ba52880066aa008cbf40b3d580d1e6b388880eaaaa11bfbf4dd5d588e6e6b8ab8b00d6ae00e0c240ebd780f3e7b3be6d00ee8800f2a640f7c480fadcb3b1440edd5511e6804deeaa88f5ccb8865a5aa87070be9494d4b8b8e5d4d47057708c6d8ca992a9c6b6c6ddd3dd4e5d6c6274878997a5b1bac3d0d6db5a69867083a894a2beb8c1d4d4dae54a716c5c8d8785aaa5aec6c3cedddb6e6e41898951a7a77dc4c4a8dcdccb8d6f47b08b59c4a883d8c5ace7dcce".substring(n*30+t*6,n*30+(t+1)*6)}var i=n!=null&&n!=undefined?n:e.theme;return[t(i,0),t(i,1),t(i,2),t(i,3)]}function a(n,t){return n.replace(/\$\{([\w]+)\}/g,function(n,i){var r=t[i];return typeof r!="undefined"?r:n})}function or(n){return n<10?"0"+n+":00":n+":00"}function d(n,t,i,r){var f=i!=undefined?n.getFullYear()!=(new Date).getFullYear():!0,e=!0,o=!0,h=i||!1,s=r||!1,u;return t&&(f=t.getFullYear()!=n.getFullYear(),t.getFullYear()==n.getFullYear()&&n.getMonth()==t.getMonth()&&n.getDate()==t.getDate()&&(f=e=o=s=!1)),u=[],f?u.push(i18n.xgcalendar.dateformat.fulldayshow):e?u.push(i18n.xgcalendar.dateformat.Md3):o&&u.push(i18n.xgcalendar.dateformat.day),u.push(s?" (W)":"",h?" HH:mm":""),u.join("")}function ft(n,i,r,u){if(i){var e=t.call(n,d(n,null,r,u)),f=t.call(i,d(i,n,r,u)),o=f!=""?" - ":"";return[e,f].join(o)}return t.call(n,d(n,null,r))}function et(){var n=kt(),t=sr(n.start,n.end);t||at()}function sr(n,i){var s=e.loadDateR.length,f,u,o,r;if(s==0)return!1;for(f=!1,u=!1,o=0;o<s;o++)if(f=!1,u=!1,r=e.loadDateR[o],n>=r.startdate&&n<=r.enddate&&(f=!0),(t.call(n,"yyyyMMdd")==t.call(r.startdate,"yyyyMMdd")||t.call(n,"yyyyMMdd")==t.call(r.enddate,"yyyyMMdd"))&&(f=!0),i?(i>=r.startdate&&i<=r.enddate&&(u=!0),(t.call(i,"yyyyMMdd")==t.call(r.startdate,"yyyyMMdd")||t.call(i,"yyyyMMdd")==t.call(r.enddate,"yyyyMMdd"))&&(u=!0)):u=!0,f&&u)break;return f&&u}function v(n,t,i,r,u,f,e,o,s){var h=s!=undefined&&s>=0?w(s):w();return a(wt,{bdcolor:h[0],bgcolor2:h[0],bgcolor1:h[2],data:"",starttime:[c(n),c(t)].join(":"),endtime:[c(i),c(r)].join(":"),content:f?f:i18n.xgcalendar.new_event,title:f?f:i18n.xgcalendar.new_event,icon:'<I class="cic cic-tmr">&nbsp;<\/I>',top:"0px",left:"",width:e?e:"100%",height:u-4,i:"-1",drag:"drag-chip",redisplay:o?"block":"none"})}function g(n){var t=n.find("div.dhdV"),i;return t.length==1?(i=t.text(),hr(i.split("$"))):null}function hr(n){if(n.length>6){var t=[];return t.push(n[0],n[1],new Date(n[2]),new Date(n[3]),parseInt(n[4]),parseInt(n[5]),parseInt(n[6]),n[7]!=undefined?parseInt(n[7]):-1,n[8]!=undefined?parseInt(n[8]):0,n[9],n[10]),t}return null}function ui(t){n("#bbit-cs-buddle").css("visibility","hidden");var i=n("#bbit-cs-id").val(),u=[{name:"calendarId",value:i},{name:"type",value:t}],r=yt(i,!0);e.onBeforeRequestData&&e.onBeforeRequestData(3);n.post(e.quickDeleteUrl,u,function(n){n&&(n.IsSuccess?(r=null,e.onAfterRequestData&&e.onAfterRequestData(3)):(e.onRequestDataError&&e.onRequestDataError(3,n),st(r),o(),e.onAfterRequestData&&e.onAfterRequestData(3)))},"json");o()}function fi(n,t){var i=n-110,r=t-217,u=document.documentElement.clientWidth,f=document.documentElement.clientHeight,e=!1;return(i<=0||r<=0||i+400>u)&&(i=n-200<=0?10:n-200,r=t-159<=0?10:t-159,i+400>=u&&(i=u-410),r+164>=f&&(r=f-165),e=!0),{left:i,top:r,hide:e}}function ot(i,f){var c,o,h,s,l,y;if(f==undefined&&(f=g(n(this))),f!=null)if(e.quickDeleteUrl!=""&&f[8]==1&&e.readonly!=!0){if(c='<div id="bbit-cs-buddle" style="z-index: 180; width: 400px;visibility:hidden;" class="bubble"><table class="bubble-table" cellSpacing="0" cellPadding="0"><tbody><tr><td class="bubble-cell-side"><div id="tl1" class="bubble-corner"><div class="bubble-sprite bubble-tl"><\/div><\/div><td class="bubble-cell-main"><div class="bubble-top"><\/div><td class="bubble-cell-side"><div id="tr1" class="bubble-corner"><div class="bubble-sprite bubble-tr"><\/div><\/div>  <tr><td class="bubble-mid" colSpan="3"><div style="overflow: hidden" id="bubbleContent1"><div><div><\/div><div class="cb-root"><table class="cb-table" cellSpacing="0" cellPadding="0"><tbody><tr><td class="cb-value"><div class="textbox-fill-wrapper"><div class="textbox-fill-mid"><div id="bbit-cs-what" title="'+i18n.xgcalendar.click_to_detail+'" class="textbox-fill-div lk" style="cursor:pointer;"><\/div><\/div><\/div><\/td><\/tr><tr><td class=cb-value><div id="bbit-cs-buddle-timeshow"><\/div><\/td><\/tr><\/tbody><\/table><div class="bbit-cs-split"><input id="bbit-cs-id" type="hidden" value=""/>[ <span id="bbit-cs-delete" class="lk">'+i18n.xgcalendar.i_delete+'<\/span> ]&nbsp; <SPAN id="bbit-cs-editLink" class="lk">'+i18n.xgcalendar.update_detail+' <StrONG>&gt;&gt;<\/StrONG><\/SPAN><\/div><\/div><\/div><\/div><tr><td><div id="bl1" class="bubble-corner"><div class="bubble-sprite bubble-bl"><\/div><\/div><td><div class="bubble-bottom"><\/div><td><div id="br1" class="bubble-corner"><div class="bubble-sprite bubble-br"><\/div><\/div><\/tr><\/tbody><\/table><div id="bubbleClose2" class="bubble-closebutton"><\/div><div id="prong1" class="prong"><div class=bubble-sprite><\/div><\/div><\/div>',o=n("#bbit-cs-buddle"),o.length==0){o=n(c).appendTo(document.body);var a=n("#bbit-cs-delete"),v=n("#bbit-cs-editLink"),p=n("#bubbleClose2").click(function(){n("#bbit-cs-buddle").css("visibility","hidden")});a.click(function(){var i=n("#bbit-cs-buddle").data("cdata"),t;e.DeleteCmdhandler&&n.isFunction(e.DeleteCmdhandler)?e.DeleteCmdhandler.call(this,i,ui):confirm(i18n.xgcalendar.confirm_delete_event+"?")&&(t=0,t=i[6]==1?confirm(i18n.xgcalendar.confrim_delete_event_or_all)?0:1:0,ui(t))});n("#bbit-cs-what").click(function(){return e.ViewCmdhandler?e.ViewCmdhandler&&n.isFunction(e.ViewCmdhandler)&&e.ViewCmdhandler.call(this,n("#bbit-cs-buddle").data("cdata")):alert("ViewCmdhandler"+i18n.xgcalendar.i_undefined),n("#bbit-cs-buddle").css("visibility","hidden"),!1});v.click(function(){return window.location=linkContent+"calendar/edit",!1});o.click(function(){return!1})}h=fi(i.pageX,i.pageY);h.hide?n("#prong1").hide():n("#prong1").show();s=[];l=r("d",f[2],f[3])!=0;s.push(t.call(f[2],i18n.xgcalendar.dateformat.Md3)," (",u[f[2].getDay()],")");f[4]!=1&&s.push(",",t.call(f[2],"HH:mm"));l&&(s.push(" - ",t.call(f[3],i18n.xgcalendar.dateformat.Md3)," (",u[f[3].getDay()],")"),f[4]!=1&&s.push(",",t.call(f[3],"HH:mm")));y=n("#bbit-cs-buddle-timeshow").html(s.join(""));n("#bbit-cs-what").html(f[1]);n("#bbit-cs-id").val(f[0]);o.data("cdata",f);o.css({visibility:"visible",left:h.left,top:h.top});n(document).one("click",function(){n("#bbit-cs-buddle").css("visibility","hidden")})}else e.ViewCmdhandler?e.ViewCmdhandler&&n.isFunction(e.ViewCmdhandler)&&e.ViewCmdhandler.call(this,f):alert("ViewCmdhandler"+i18n.xgcalendar.i_undefined);else alert(i18n.xgcalendar.data_format_error);return!1}function cr(i){var h=n(this),rt=i.id.split("_")[1],ut=n(i),p=h.position(),ft=ut.position(),w=(h.width()+2)*1.5,c=ft.top+15,l=p.left,et=this.abbr,a=et.split("/"),v=new Date(a[0],parseInt(a[1]-1),a[2]),b=n("#cal-month-cc"),y=n("#cal-month-cc-content table tbody"),st=n("#cal-month-cc-title"),r,g,o,s,it;st.html(t.call(v,i18n.xgcalendar.dateformat.Md3)+" "+u[v.getDay()]);y.empty();var k=n("#gridEvent").data("mvdata"),f=k[rt],d=parseInt(this.axis),e=[];for(r=0;r<=d;r++)for(g=f[r]?f[r].length:0,o=0;o<g;o++)s=f[r][o],s&&s.colSpan+r-1>=d&&(e.push("<tr><td class='st-c'>"),e.push(lt(s,v,1)),e.push("<\/td><\/tr>"));y.html(e.join(""));y.find("div.rb-o").each(function(){n(this).click(ot)});k=f=null;var nt=b.height(),ht=document.documentElement.clientWidth,tt=document.documentElement.clientHeight;l+w>=ht&&(l=p.left-(h.width()+2)*.5);c+nt>=tt&&(c=tt-nt-2);it={left:l,top:c,"z-index":180,width:w,visibility:"visible"};b.css(it);n(document).one("click",ni);return!1}function vt(i,r,u){if(e.quickUpdateUrl!=""&&i[8]==1&&e.readonly!=!0){if(e.isloading)return!1;e.isloading=!0;var s=i[0],c=i[2],l=i[3],a=(new Date).getTimezoneOffset()/-60,h=[{name:"calendarId",value:s},{name:"CalendarStartTime",value:t.call(r,i18n.xgcalendar.dateformat.fulldayvalue+" HH:mm")},{name:"CalendarEndTime",value:t.call(u,i18n.xgcalendar.dateformat.fulldayvalue+" HH:mm")},{name:"timezone",value:a}],f;e.quickUpdateHandler&&n.isFunction(e.quickUpdateHandler)?e.quickUpdateHandler.call(this,h):(e.onBeforeRequestData&&e.onBeforeRequestData(4),n.post(e.quickUpdateUrl,h,function(n){n&&(n.IsSuccess==!0?(e.isloading=!1,e.onAfterRequestData&&e.onAfterRequestData(4)):(e.onRequestDataError&&e.onRequestDataError(4,n),e.isloading=!1,f=yt(s,!0),f[2]=c,f[3]=l,st(f),o(),f=null,e.onAfterRequestData&&e.onAfterRequestData(4)))},"json"),f=yt(s,!0),f&&(f[2]=r,f[3]=u),st(f),o())}}function ei(i,u,f,s){var c,h,a,v,l,y;if((e.quickAddHandler||e.quickAddUrl!="")&&!e.readonly){if(c=n("#bbit-cal-buddle"),c.length==0){h=[];h.push('<div id="bbit-cal-buddle" style="z-index: 180; width: 400px;visibility:hidden;" class="bubble">');h.push('<table class="bubble-table" cellSpacing="0" cellPadding="0"><tbody><tr><td class="bubble-cell-side"><div id="tl1" class="bubble-corner"><div class="bubble-sprite bubble-tl"><\/div><\/div>');h.push('<td class="bubble-cell-main"><div class="bubble-top"><\/div><td class="bubble-cell-side"><div id="tr1" class="bubble-corner"><div class="bubble-sprite bubble-tr"><\/div><\/div>  <tr><td class="bubble-mid" colSpan="3"><div style="overflow: hidden" id="bubbleContent1"><div><div><\/div><div class="cb-root">');h.push('<table class="cb-table" cellSpacing="0" cellPadding="0"><tbody><tr><th class="cb-key">');h.push(i18n.xgcalendar.time,':<\/th><td class=cb-value><div id="bbit-cal-buddle-timeshow"><\/div><\/td><\/tr><tr><th class="cb-key">');h.push(i18n.xgcalendar.content,':<\/th><td class="cb-value"><div class="textbox-fill-wrapper"><div class="textbox-fill-mid"><input id="bbit-cal-what" class="textbox-fill-input"/><\/div><\/div><div class="cb-example">');h.push(i18n.xgcalendar.example,'<\/div><\/td><\/tr><\/tbody><\/table><input id="bbit-cal-start" type="hidden"/><input id="bbit-cal-end" type="hidden"/><input id="bbit-cal-allday" type="hidden"/><input id="bbit-cal-quickAddBTN" value="');h.push(i18n.xgcalendar.create_event,'" type="button"/>&nbsp; <SPAN id="bbit-cal-editLink" class="lk">');h.push(i18n.xgcalendar.update_detail,' <StrONG>&gt;&gt;<\/StrONG><\/SPAN><\/div><\/div><\/div><tr><td><div id="bl1" class="bubble-corner"><div class="bubble-sprite bubble-bl"><\/div><\/div><td><div class="bubble-bottom"><\/div><td><div id="br1" class="bubble-corner"><div class="bubble-sprite bubble-br"><\/div><\/div><\/tr><\/tbody><\/table><div id="bubbleClose1" class="bubble-closebutton"><\/div><div id="prong2" class="prong"><div class=bubble-sprite><\/div><\/div><\/div>');a=h.join("");h=null;n(document.body).append(a);c=n("#bbit-cal-buddle");var p=n("#bbit-cal-quickAddBTN"),w=n("#bbit-cal-editLink"),b=n("#bubbleClose1").click(function(){n("#bbit-cal-buddle").css("visibility","hidden");tt()});p.click(function(){var a,t,u,i,f;if(e.isloading)return!1;e.isloading=!0;var s=n("#bbit-cal-what").val(),h=n("#bbit-cal-start").val(),c=n("#bbit-cal-end").val(),l=n("#bbit-cal-allday").val(),p=/^[^\$\<\>]+$/.test(s);if(!p)return alert(i18n.xgcalendar.invalid_title),n("#bbit-cal-what").focus(),e.isloading=!1,!1;if(a=(new Date).getTimezoneOffset()/-60,t=[{name:"CalendarTitle",value:s},{name:"CalendarStartTime",value:h},{name:"CalendarEndTime",value:c},{name:"IsAllDayEvent",value:l},{name:"timezone",value:a}],e.extParam)for(u=0;u<e.extParam.length;u++)t[t.length]=e.extParam[u];if(e.quickAddHandler&&n.isFunction(e.quickAddHandler))e.quickAddHandler.call(this,t),n("#bbit-cal-buddle").css("visibility","hidden"),tt();else{n("#bbit-cal-buddle").css("visibility","hidden");i=[];f=-1;e.onBeforeRequestData&&e.onBeforeRequestData(2);n.post(e.quickAddUrl,t,function(n){n&&(n.IsSuccess==!0?(e.isloading=!1,e.eventItems[f][0]=n.Data,e.eventItems[f][8]=1,o(),e.onAfterRequestData&&e.onAfterRequestData(2)):(e.onRequestDataError&&e.onRequestDataError(2,n),e.isloading=!1,e.onAfterRequestData&&e.onAfterRequestData(2)))},"json");i.push(-1,s);var v=nt(h),y=nt(c),w=r("d",v,y);i.push(v,y,l=="1"?1:0,w>0?1:0,0);i.push(-1,0,"","");f=st(i);tt();o()}});w.click(function(){return window.location=linkContent+"calendar/create",!1});c.mousedown(function(){return!1})}v=ft(i,u,!f,!0);l=fi(s.left,s.top);l.hide?n("#prong2").hide():n("#prong2").show();n("#bbit-cal-buddle-timeshow").html(v);y=n("#bbit-cal-what").val("");n("#bbit-cal-allday").val(f?"1":"0");n("#bbit-cal-start").val(t.call(i,i18n.xgcalendar.dateformat.fulldayvalue+" HH:mm"));n("#bbit-cal-end").val(t.call(u,i18n.xgcalendar.dateformat.fulldayvalue+" HH:mm"));c.css({visibility:"visible",left:l.left,top:l.top});y.blur().focus();n(document).one("mousedown",function(){n("#bbit-cal-buddle").css("visibility","hidden");tt()});return!1}}function nt(n){var r=n.split(" "),t=r[0].split(i18n.xgcalendar.dateformat.separator),i=r[1].split(":"),u=t[i18n.xgcalendar.dateformat.year_index],f=t[i18n.xgcalendar.dateformat.month_index].indexOf("0")==0?t[i18n.xgcalendar.dateformat.month_index].substr(1,1):t[i18n.xgcalendar.dateformat.month_index],e=t[i18n.xgcalendar.dateformat.day_index].indexOf("0")==0?t[i18n.xgcalendar.dateformat.day_index].substr(1,1):t[i18n.xgcalendar.dateformat.day_index],o=i[0].indexOf("0")==0?i[0].substr(1,1):i[0],s=i[1].indexOf("0")==0?i[1].substr(1,1):i[1];return new Date(u,parseInt(f)-1,e,o,s)}function yt(n,t){var u,i,r,f;if(e.eventItems&&e.eventItems.length>0){for(u=e.eventItems.length,i=-1,r=0;r<u;r++)if(e.eventItems[r][0]==n){i=r;break}if(i>=0)return f=e.eventItems[i],t&&e.eventItems.splice(i,1),f}return null}function st(n,t){var f=0,i;if(t)f=1;else if(e.eventItems&&e.eventItems.length>0){var r=e.eventItems.length,u=n[2],o=u.getTime()-e.eventItems[0][2].getTime(),s=e.eventItems[r-1][2].getTime()-u.getTime(),h=o-s;if(o<0||h<0){for(i=0;i<r;i++)if(e.eventItems[i][2]>=u){t=i;break}}else if(s<0)t=r;else for(i=r-1;i>=0;i--)if(e.eventItems[i][2]<u){t=i+1;break}}else t=0;return e.eventItems&&e.eventItems.length>0?t==e.eventItems.length?e.eventItems.push(n):e.eventItems.splice(t,f,n):e.eventItems=[n],t}function lr(){var p=document.documentElement.clientHeight,r=e.view,u,t,o,s;if(r=="day"||r=="week"){if(u=n("#dvwkcontaienr"),t=n("#dvtec"),u.length==0||t.length==0){alert(i18n.xgcalendar.view_no_ready);return}if(o=u.height()+2,s=e.height-8-o,t.height(s),typeof e.scoll=="undefined"){var h=new Date,c=h.getHours(),v=h.getMinutes(),y=l(c,v),f=t.attr("clientHeight"),i=y-.5*f,a=t.attr("scrollHeight");i<0&&(i=0);i>a-f&&(i=a-f-10*(23-c));t.attr("scrollTop",i)}else t.attr("scrollTop",e.scoll)}else r=="month"}function pt(){return!1}function ar(t){t=="week"||t=="day"?(n("div.chip",h).each(function(){var t=n(this);t.click(ot);t.hasClass("drag")?(t.mousedown(function(n){return y.call(this,"dw3",n),!1}),t.find("div.resizer").mousedown(function(t){return y.call(n(this).parent().parent(),"dw4",t),!1})):t.mousedown(pt)}),n("div.rb-o",h).each(function(){var i=n(this);i.click(ot);i.hasClass("drag")&&t=="week"?i.mousedown(function(n){return y.call(this,"dw5",n),!1}):i.mousedown(pt)}),e.readonly==!1&&(n("td.tg-col",h).each(function(){n(this).mousedown(function(n){return y.call(this,"dw1",n),!1})}),n("#weekViewAllDaywk").mousedown(function(n){return y.call(this,"dw2",n),!1})),t=="week"&&n("#dvwkcontaienr th.gcweekname").each(function(){n(this).click(ii)})):(t="month")&&(n("div.rb-o",h).each(function(){var t=n(this);t.click(ot);t.hasClass("drag")?t.mousedown(function(n){return y.call(this,"m2",n),!1}):t.mousedown(pt)}),n("td.st-more",h).each(function(){n(this).click(function(){return cr.call(this,n(this).parent().parent().parent().parent()[0]),!1}).mousedown(function(){return!1})}),e.readonly==!1&&n("#mvEventContainer").mousedown(function(n){return y.call(this,"m1",n),!1}))}function tt(){k&&(k(),k=null)}function y(t,i){var f=n(this),yt=i.srcElement||i.target,l,rt,p,ut,c,a,u;tt();switch(t){case"dw1":s={type:1,target:f,sx:i.pageX,sy:i.pageY};break;case"dw2":var v=f.width(),l=f.height(),w=f.offset(),y=w.left,b=w.top,h=e.view=="day"?1:7,d=v%h,o=parseInt(v/h);for(d>h/2+1&&o++,c=[],a=[],u=0;u<h;u++)c.push({s:u*o+y,e:(u+1)*o+y});a.push({s:b,e:b+l});s={type:2,target:f,sx:i.pageX,sy:i.pageY,pw:o,xa:c,ya:a,h:l};v=y=h=d=o=c=null;break;case"dw3":var st=f.parent().attr("id").replace("tgCol",""),ht=f.parent(),ct=ht.offset(),v=ht.width()+10,l=f.height(),p=g(f);s={type:4,target:f,sx:i.pageX,sy:i.pageY,pXMin:ct.left,pXMax:ct.left+v,pw:v,h:l,cdi:parseInt(st),fdi:parseInt(st),data:p};break;case"dw4":l=f.height();p=g(f);s={type:5,target:f,sx:i.pageX,sy:i.pageY,h:l,data:p};break;case"dw5":var nt=n("#weekViewAllDaywk"),v=nt.width(),l=nt.height(),w=nt.offset(),k=f.offset(),y=w.left,b=w.top,h=7,d=v%h,o=parseInt(v/h);d>h/2+1&&o++;var c=[],a=[],it=0;for(u=0;u<h;u++)c.push({s:u*o+y,e:(u+1)*o+y}),k.left>=c[u].s&&k.left<c[u].e&&(it=u);rt={x:it,y:0,di:it};a.push({s:b,e:b+l});p=g(f);ut=r("d",p[2],p[3])+1;s={type:6,target:f,sx:i.pageX,sy:i.pageY,data:p,xa:c,ya:a,fdi:rt,h:l,dp:ut,pw:o};break;case"m1":var v=f.width(),w=f.offset(),y=w.left,b=w.top,h=7,lt=f.children().length,d=v%h,o=parseInt(v/h);d>h/2+1&&o++;var l=n("#mvrow_0").height(),c=[],a=[];for(u=0;u<h;u++)c.push({s:u*o+y,e:(u+1)*o+y});for(c=[],a=[],u=0;u<h;u++)c.push({s:u*o+y,e:(u+1)*o+y});for(u=0;u<lt;u++)a.push({s:u*l+b,e:(u+1)*l+b});s={type:3,target:f,sx:i.pageX,sy:i.pageY,pw:o,xa:c,ya:a,h:l};break;case"m2":var ft=n("#mvrow_0"),at=n("#mvrow_1"),v=ft.width(),w=ft.offset(),vt=at.offset(),k=f.offset(),l=vt.top-w.top,y=w.left,b=w.top,h=7,lt=ft.parent().children().length,d=v%h,o=parseInt(v/h);d>h/2+1&&o++;var c=[],a=[],et=0,ot=0;for(u=0;u<h;u++)c.push({s:u*o+y,e:(u+1)*o+y}),k.left>=c[u].s&&k.left<c[u].e&&(et=u);for(u=0;u<lt;u++)a.push({s:u*l+b,e:(u+1)*l+b}),k.top>=a[u].s&&k.top<a[u].e&&(ot=u);var rt={x:et,y:ot,di:ot*7+et},p=g(f),ut=r("d",p[2],p[3])+1;s={type:7,target:f,sx:i.pageX,sy:i.pageY,data:p,xa:c,ya:a,fdi:rt,h:l,dp:ut,pw:o}}n("body").noSelect()}function vr(t){var i,nt,k,et,ot,u,r,o,c,tt,rt,st,ht,ft,d,h,f;if(s){if(t.pageX<0||t.pageY<0||t.pageX>document.documentElement.clientWidth||t.pageY>=document.documentElement.clientHeight)return oi(t),!1;i=s;switch(i.type){case 1:var w=i.sy,b=t.pageY,e=b-w;(e>11||e<-11||i.cpwrap)&&(e==0&&(e=21),nt=e%21,nt!=0&&(e=nt>0?e+21-nt:e-21-nt,b=i.sy+e,e<0&&(w=w+21)),i.tp||(i.tp=n(i.target).offset().top),r=ri(w,b,i.tp),o=l(r.sh,r.sm),i.cpwrap?(i.cgh.sh!=r.sh||i.cgh.eh!=r.eh||i.cgh.sm!=r.sm||i.cgh.em!=r.em)&&(c=v(r.sh,r.sm,r.eh,r.em,r.h),i.cpwrap.css("top",o+"px").html(c)):(c=v(r.sh,r.sm,r.eh,r.em,r.h),h=n("<div class='ca-evpi drag-chip-wrapper' style='top:"+o+"px'/>").html(c),n(i.target).find("div.tg-col-overlaywrapper").append(h),i.cpwrap=h),i.cgh=r);break;case 2:var g=i.sx,a=t.pageX,y=a-g;(y>5||y<-5||i.lasso)&&(i.lasso||(i.lasso=n("<div style='z-index: 10; display: block' class='drag-lasso-container'/>"),n(document.body).append(i.lasso)),i.sdi||(i.sdi=p(i.xa,i.ya,g,i.sy)),f=p(i.xa,i.ya,a,t.pageY),i.fdi&&i.fdi.di==f.di||it(i.lasso,i.sdi,f,i.xa,i.ya,i.h),i.fdi=f);break;case 3:var g=i.sx,a=t.pageX,w=i.sy,b=t.pageY,y=a-g,e=b-w;(y>5||y<-5||e<-5||e>5||i.lasso)&&(i.lasso||(i.lasso=n("<div style='z-index: 10; display: block' class='drag-lasso-container'/>"),n(document.body).append(i.lasso)),i.sdi||(i.sdi=p(i.xa,i.ya,g,w)),f=p(i.xa,i.ya,a,b),i.fdi&&i.fdi.di==f.di||it(i.lasso,i.sdi,f,i.xa,i.ya,i.h),i.fdi=f);break;case 4:if(u=i.data,u!=null&&u[8]==1){var g=i.sx,a=t.pageX,w=i.sy,b=t.pageY,y=a-g,e=b-w;(y>5||y<-5||e>5||e<-5||i.cpwrap)&&(i.cpwrap?(k=0,a<i.pXMin?k=-1:a>i.pXMax&&(k=1),k!=0&&(i.cdi=i.cdi+k,et=n("#tgOver"+i.cdi),et.length==1?(i.pXMin=i.pXMin+i.pw*k,i.pXMax=i.pXMax+i.pw*k,et.append(i.cpwrap)):i.cdi=i.cdi-k),o=i.top+e,ot=o%21,ot!=0&&(o=o-ot),i.ny!=o&&(r=ut(o,o+i.h),c=v(r.sh,r.sm,r.eh,r.em,r.h,u[1],!1,!1,u[7]),i.cpwrap.css("top",o+"px").html(c)),i.ny=o):(r={sh:u[2].getHours(),sm:u[2].getMinutes(),eh:u[3].getHours(),em:u[3].getMinutes(),h:i.h},i.target.hide(),o=l(r.sh,r.sm),i.top=o,c=v(r.sh,r.sm,r.eh,r.em,r.h,u[1],!1,!1,u[7]),h=n("<div class='ca-evpi drag-chip-wrapper' style='top:"+o+"px'/>").html(c),tt=i.target.parent().attr("id").replace("tgCol","#tgOver"),n(tt).append(h),i.cpwrap=h,i.ny=o))}break;case 5:if(u=i.data,u!=null&&u[8]==1){var w=i.sy,b=t.pageY,e=b-w;(e!=0||i.cpwrap)&&(i.cpwrap?(nh=i.h+e,rt=nh%21,nh=rt>1?nh-rt+21:nh-rt,i.nh!=nh&&(st=l(u[2].getHours(),u[2].getMinutes()),ht=st+nh,r=ut(i.top,i.top+nh),c=v(r.sh,r.sm,r.eh,r.em,r.h,u[1],"100%",!0,u[7]),i.cpwrap.html(c)),i.nh=nh):(r={sh:u[2].getHours(),sm:u[2].getMinutes(),eh:u[3].getHours(),em:u[3].getMinutes(),h:i.h},i.target.hide(),o=l(r.sh,r.sm),i.top=o,c=v(r.sh,r.sm,r.eh,r.em,r.h,u[1],"100%",!0,u[7]),h=n("<div class='ca-evpi drag-chip-wrapper' style='top:"+o+"px'/>").html(c),tt=i.target.parent().attr("id").replace("tgCol","#tgOver"),n(tt).append(h),i.cpwrap=h))}break;case 6:var g=i.sx,a=t.pageX,b=t.pageY,y=a-g;(y>5||y<-5||i.lasso)&&(i.lasso||(ft=i.dp>1?(i.pw-4)*1.5:i.pw-4,d=i.target.clone(),i.dp>1&&d.find("div.rb-i>span").prepend("("+i.dp+" "+i18n.xgcalendar.day_plural+")&nbsp;"),h=n("<div class='drag-event st-contents' style='width:"+ft+"px'/>").append(d).appendTo(document.body),i.cpwrap=h,i.lasso=n("<div style='z-index: 10; display: block' class='drag-lasso-container'/>"),n(document.body).append(i.lasso),d=h=null),si(i.cpwrap,t,i.xa,i.ya),f=p(i.xa,i.ya,a,t.pageY),i.cdi&&i.cdi.di==f.di||it(i.lasso,f,{x:f.x,y:f.y,di:f.di+i.dp-1},i.xa,i.ya,i.h),i.cdi=f);break;case 7:var g=i.sx,w=i.sy,a=t.pageX,b=t.pageY,y=a-g,e=b-w;(y>5||y<-5||e>5||e<-5||i.lasso)&&(i.lasso||(ft=i.dp>1?(i.pw-4)*1.5:i.pw-4,d=i.target.clone(),i.dp>1&&d.find("div.rb-i>span").prepend("("+i.dp+" "+i18n.xgcalendar.day_plural+")&nbsp;"),h=n("<div class='drag-event st-contents' style='width:"+ft+"px'/>").append(d).appendTo(document.body),i.cpwrap=h,i.lasso=n("<div style='z-index: 10; display: block' class='drag-lasso-container'/>"),n(document.body).append(i.lasso),d=h=null),si(i.cpwrap,t,i.xa,i.ya),f=p(i.xa,i.ya,a,t.pageY),i.cdi&&i.cdi.di==f.di||it(i.lasso,f,{x:f.x,y:f.y,di:f.di+i.dp-1},i.xa,i.ya,i.h),i.cdi=f)}}return!1}function oi(t){var u,a,c,o,h,y,w;if(s){u=s;switch(u.type){case 1:if(a=(new Date).getTime(),tp=u.target.offset().top,!u.cpwrap){var f=ri(u.sy,u.sy+42,tp),g=l(f.sh,f.sm),tt=v(f.sh,f.sm,f.eh,f.em,f.h);u.cpwrap=n("<div class='ca-evpi drag-chip-wrapper' style='top:"+g+"px'/>").html(tt);n(u.target).find("div.tg-col-overlaywrapper").append(u.cpwrap);u.cgh=f}c=u.cpwrap.offset();c.left=c.left+30;u.cpwrap.attr("id",a);o=nt(u.target.attr("abbr")+" "+u.cgh.sh+":"+u.cgh.sm);h=nt(u.target.attr("abbr")+" "+u.cgh.eh+":"+u.cgh.em);k=function(){n("#"+a).remove();n("#bbit-cal-buddle").css("visibility","hidden")};ei(o,h,!1,c);break;case 2:case 3:if(y=t.srcElement||t.target,w=(new Date).getTime(),!u.lasso){if(n(y).hasClass("monthdayshow")){ii.call(n(y).parent()[0],t);break}u.fdi=u.sdi=p(u.xa,u.ya,u.sx,u.sy);u.lasso=n("<div style='z-index: 10; display: block' class='drag-lasso-container'/>");n(document.body).append(u.lasso);it(u.lasso,u.sdi,u.fdi,u.xa,u.ya,u.h)}u.lasso.attr("id",w);var rt=Math.min(u.fdi.di,u.sdi.di),ft=Math.max(u.fdi.di,u.sdi.di),b=e.vstart,o=i("d",rt,b),h=i("d",ft,b);k=function(){n("#"+w).remove()};ei(o,h,!0,{left:t.pageX,top:t.pageY});break;case 4:if(u.cpwrap){var o=i("d",u.cdi,e.vstart),h=i("d",u.cdi,e.vstart),f=ut(u.ny,u.ny+u.h);o.setHours(f.sh,f.sm);h.setHours(f.eh,f.em);o.getTime()==u.data[2].getTime()&&h.getTime()==u.data[3].getTime()?(u.cpwrap.remove(),u.target.show()):vt(u.data,o,h)}break;case 5:if(u.cpwrap){var o=new Date(u.data[2].toString()),h=new Date(u.data[3].toString()),f=ut(u.top,u.top+nh);o.setHours(f.sh,f.sm);h.setHours(f.eh,f.em);o.getTime()==u.data[2].getTime()&&h.getTime()==u.data[3].getTime()?(u.cpwrap.remove(),u.target.show()):vt(u.data,o,h)}break;case 6:case 7:if(u.lasso){u.cpwrap.remove();u.lasso.remove();var o=new Date(u.data[2].toString()),h=new Date(u.data[3].toString()),et=i("d",u.cdi.di,e.vstart),d=r("d",o,et);o=i("d",d,o);h=i("d",d,h);(o.getTime()!=u.data[2].getTime()||h.getTime()!=u.data[3].getTime())&&vt(u.data,o,h)}}return u=s=null,n("body").noSelect(!1),!1}}function p(n,t,i,r){var o=0,s=0,e=0,h=0,u,f;if(n&&n.length!=0)if(e=n.length,i>=n[e-1].e)s=e-1;else for(u=0;u<e;u++)if(i>n[u].s&&i<=n[u].e){s=u;break}if(t&&t.length!=0)if(h=t.length,r>=t[h-1].e)o=h-1;else for(f=0;f<h;f++)if(r>t[f].s&&r<=t[f].e){o=f;break}return{x:s,y:o,di:o*e+s}}function it(n,t,i,r,u,f){var e=t.di>i.di?t.di-i.di:i.di-t.di;e++;for(var l=t.di>i.di?i:t,d=t.di>i.di?t:i,s=r.length>0?r.length:1,w=u.length>0?u.length:1,v=[],b=r[0].e-r[0].s,o=l.x,h=l.y,k=Math.min(document.documentElement.clientWidth,r[s-1].e)-2;h<w&&e>0;){for(var y=r[o].s,p=o+e>s?s-o:e,c=b*p;y+c>=k;)c--;v.push(a(vi,{left:y,top:u[h].s,height:f,width:c}));o=0;e=e-p;h++}n.html(v.join(""))}function si(n,t,i,r){var u=t.pageX-6,f=t.pageY-4,c=n.width(),e=i[0].s+6,o=r[0].s+4,s=i[i.length-1].e-c-2,h=r[r.length-1].e-23;u>s&&(u=s);u<=e&&(u=e+1);f<=o&&(f=o+1);f>h&&(f=h);n.css({left:u,top:f})}var ci={view:"week",weekstartday:1,theme:0,height:!1,url:"",eventItems:[],method:"POST",showday:new Date,onBeforeRequestData:!1,onAfterRequestData:!1,onRequestDataError:!1,onWeekOrMonthToDay:!1,quickAddHandler:!1,quickAddUrl:"",quickUpdateUrl:"",quickDeleteUrl:"",autoload:!1,readonly:!1,extParam:[],enableDrag:!0,loadDateR:[]},ht=n("#gridEvent"),h,ct,hi;ht.length==0&&(ht=n("<div id='gridEvent' style='display:none;'><\/div>").appendTo(document.body));h=n(this);e=n.extend(ci,e);(e.quickUpdateUrl==null||e.quickUpdateUrl=="")&&(e.enableDrag=!1);var wt='<DIV style="WIDTH:${width};top:${top};left:${left};" title="${title}" class="chip chip${i} ${drag}"><div class="dhdV" style="display:none">${data}<\/div><DIV style="BORDER-BOTTOM-COLOR:${bdcolor}" class=ct>&nbsp;<\/DIV><DL style="BORDER-BOTTOM-COLOR:${bdcolor}; BACKGROUND-COLOR:${bgcolor1}; BORDER-TOP-COLOR: ${bdcolor}; HEIGHT: ${height}px; BORDER-RIGHT-COLOR:${bdcolor}; BORDER-LEFT-COLOR:${bdcolor}"><DT style="BACKGROUND-COLOR:${bgcolor2}">${starttime} - ${endtime} ${icon}<\/DT><DD><SPAN>${content}<\/SPAN><\/DD><DIV class=\'resizer\' style=\'display:${redisplay}\'><DIV class=rszr_icon>&nbsp;<\/DIV><\/DIV><\/DL><DIV style="BORDER-BOTTOM-COLOR:${bdcolor}; BACKGROUND-COLOR:${bgcolor1}; BORDER-TOP-COLOR: ${bdcolor}; BORDER-RIGHT-COLOR: ${bdcolor}; BORDER-LEFT-COLOR:${bdcolor}" class=cb1>&nbsp;<\/DIV><DIV style="BORDER-BOTTOM-COLOR:${bdcolor}; BORDER-TOP-COLOR:${bdcolor}; BORDER-RIGHT-COLOR:${bdcolor}; BORDER-LEFT-COLOR:${bdcolor}" class=cb2>&nbsp;<\/DIV><\/DIV>',li='<div class="rb-o ${eclass}" id="${id}" title="${title}" style="color:${color};"><div class="dhdV" style="display:none">${data}<\/div><div class="${extendClass} rb-m" style="background-color:${color}">${extendHTML}<div class="rb-i">${content}<\/div><\/div><\/div>',ai=[31,28,31,30,31,30,31,31,30,31,30,31],vi="<div class='drag-lasso' style='left:${left}px;top:${top}px;width:${width}px;height:${height}px;'>&nbsp;<\/div>",s,k;return bt(),e.height||(e.height=document.documentElement.clientHeight),h.css("overflow-y","visible").height(e.height-8),e.url&&e.autoload?at():(o(),ct=kt(),dt(ct.start,ct.end)),n(document).mousemove(vr).mouseup(oi),hi={sv:function(n){n!=e.view&&(bt(),e.view=n,o(),et())},rf:function(){at()},gt:function(n){n||(n=new Date);e.showday=n;o();et()},pv:function(){switch(e.view){case"day":e.showday=i("d",-1,e.showday);break;case"week":e.showday=i("w",-1,e.showday);break;case"month":e.showday=i("m",-1,e.showday)}o();et()},nt:function(){var t,n;switch(e.view){case"day":e.showday=i("d",1,e.showday);break;case"week":e.showday=i("w",1,e.showday);break;case"month":t=e.showday.getDate();e.showday=i("m",1,e.showday);n=e.showday.getDate();t!=n&&(e.showday=i("d",0-n,e.showday))}o();et()},go:function(){return e},so:function(t){e=n.extend(e,t)}},this[0].bcal=hi,this};n.fn.swtichView=function(n){return this.each(function(){this.bcal&&this.bcal.sv(n)})};n.fn.reload=function(){return this.each(function(){this.bcal&&this.bcal.rf()})};n.fn.gotoDate=function(n){return this.each(function(){this.bcal&&this.bcal.gt(n)})};n.fn.previousRange=function(){return this.each(function(){this.bcal&&this.bcal.pv()})};n.fn.nextRange=function(){return this.each(function(){this.bcal&&this.bcal.nt()})};n.fn.BcalGetOp=function(){return this[0].bcal?this[0].bcal.go():null};n.fn.BcalSetOp=function(n){if(this[0].bcal)return this[0].bcal.so(n)}})(jQuery);
//# sourceMappingURL=jquery.calendar.min.js.map
