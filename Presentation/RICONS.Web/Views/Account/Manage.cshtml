@model RICONS.Web.Models.ManageUserViewModel
@{
    ViewBag.Title = "Danh sách người dùng";
}

@*--css--*@
@section CSS
{
    <link rel="stylesheet" type="text/css" href="@Url.Content("~")themes/RICONS-2015/css/controller/Account.ManageCSS.css" />
    <link rel="stylesheet" type="text/css" href="@Url.Content("~")themes/RICONS-2015/css/chosen/chosen.css" />
    <link rel="stylesheet" type="text/css" href="@Url.Content("~")themes/RICONS-2015/css/chosen/prism.css" />
}

@*--javascript--*@
@section JavaScript
{
    <script type="text/javascript" src="@Url.Content("~")themes/RICONS-2015/js/controllers/Account.ManageJS.js"></script>
    <script type="text/javascript" src="@Url.Content("~")themes/RICONS-2015/js/chosen/prism.js"></script>
    <script type="text/javascript" src="@Url.Content("~")themes/RICONS-2015/js/table/buildTable.js"></script>
    <script type="text/javascript" src="@Url.Content("~")themes/RICONS-2015/js/colResizale/colResizable-1.3.source.js"></script>
    <script type="text/javascript" src="@Url.Content("~")themes/RICONS-2015/js/chosen/chosen.jquery.js"></script>
    <script type="text/javascript" src="@Url.Content("~")themes/RICONS-2015/js/jquery-ui-1.10.0.custom.min.js"></script>
    <script type="text/javascript" src="@Url.Content("~")themes/RICONS-2015/js/jquery.datepick-vi.js"></script>
    <script type="text/javascript" src="@Url.Content("~")Themes/RICONS-2015/css/TableBuild/global/plugins/jquery.blockui.min.js"></script>
    <script type="text/javascript" src="@Url.Content("~")Themes/RICONS-2015/css/TableBuild/global/scripts/app.min.js"></script>

    <script type="text/javascript" src="@Url.Content("~")themes/RICONS-2015/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="@Url.Content("~")themes/RICONS-2015/js/bootbox.min.js"></script>
    <script type="text/javascript" src="@Url.Content("~")themes/RICONS-2015/js/custom.js"></script>
    @*<script type="text/javascript" src="@Url.Content("~")themes/RICONS-2015/js/colResizale/jquery.customdialog.js"></script>*@
}


<script>
    var linkContent = '@Url.Content("~")';
</script>

<div class="HeaderFixed">
    <div class="b-b b-light">

        @*<div class="row" style="color:black; line-height:30px; width:980px;">
            <div class=" col-md-3" style="font-size: 16px; font-weight: bold; line-height: 31px">&nbsp;Danh sách tài khoản người dùng</div>
            <div class="col-md-9">
                <div class="row">
                    <div class="col-md-5" style="line-height: 31px;">
                        Lọc dữ liệu theo:
                        <select id="filter01" data-placeholder="Chọn đơn vị..." class="chosen-select-donvi" name="madonvi">
                            @foreach (var item in Model.DonVis)
                            {
                                <option value="@item.madonvi">@item.tendonvi</option>
                            }
                        </select>
                        <select id="filter02" data-placeholder="Chọn phòng ban..." class="chosen-select-phongban" name="maphongban">
                            <option value="">Tất cả phòng ban</option>
                            @foreach (var item in Model.PhongBans)
                            {
                                <option value="@item.maphongban">@item.tenphongban</option>
                            }
                        </select>
                    </div>

                    <div class="col-md-2" style="line-height: 31px">
                        Export: <label><input type="checkbox" id="chkSelectKichhoat1" checked="checked" /><span id="spKichhoat1">Kích hoạt</span></label>
                    </div>

                </div>
            </div>
        </div>*@



        <div class="p-left">Tài Khoản Người Dùng</div>

            <div class="p-right">

                <div class="t-fillter c-black p-right-item">&nbsp;&nbsp;Lọc dữ liệu theo:&nbsp;</div>
                <div class="p-right-item">
                    <select id="filter01" data-placeholder="Chọn đơn vị..." class="chosen-select-donvi" name="madonvi">
                        @foreach (var item in Model.DonVis)
                        {
                            <option value="@item.madonvi">@item.tendonvi</option>
                        }
                    </select>&nbsp;
                </div> 
                <div class="p-right-item">
                    <select id="filter02" data-placeholder="Chọn phòng ban..." class="chosen-select-phongban" name="maphongban">
                        <option value="">Tất cả phòng ban</option>
                        @foreach (var item in Model.PhongBans)
                        {
                            <option value="@item.maphongban">@item.tenphongban</option>
                        }
                    </select>
                </div>

                <div class="p-right-item boxEdit" style="padding-right: 10px; padding: 0px; box-shadow: none; border: none">
                    <input id="txtdiachimail" style="width:250px" name="diachimail" placeholder="Tên đăng nhập hoặc địa chỉ mail" value="" type="text">
                </div>

                <div class="p-right-item" >
                    &nbsp;<label><input type="checkbox" id="chkSelectKichhoat1" checked="checked" /><span id="spKichhoat1">Kích hoạt</span></label>
                </div>
               
            </div>
            <div class="clearBoth"></div>
        </div>
</div>


<div class="boxEdit">
    <div id="frm-create">
        @using (Html.BeginForm("Themmoi_capnhat_Account", "Account", new { ReturnUrl = ViewBag.ReturnUrl }, FormMethod.Post))
        {
            <input type="hidden" name="act" value="create" />
            <input type="hidden" name="mataikhoan" value="" />
            
            <div class="row" style="width:100%">
                <div class="col-md-10">
                    <div class="row">
                        <div class="col-md-1"></div>
                        <div class="col-md-7"><label style="color:red" id="lblthongbao" class="hidden"></label></div>
                    </div>
                </div>
            </div>
            
            <div class="row" style="width:100%;">
                <div class="col-md-1" style="padding-left: 10px; min-width:120px;">Tên đăng nhập:</div>
                <div class="col-md-3" style="padding-left:10px;"><input type="text" style="width:100%" autocomplete="off" placeholder="Tên đăng nhập" name="tendangnhap" /></div>

                <div class="col-md-1" style="padding-left: 10px; min-width: 120px; ">Mật khẩu:</div>
                <div class="col-md-3" style="padding-left:10px;"><input type="text" style="width: 100%" autocomplete="off" placeholder="Nhập mật khẩu" name="matkhau" /></div>
            </div>
            
            <div class="row" style="width:100%">

                <div class="col-md-1" style="padding-left: 10px; min-width: 120px;">Họ và tên:</div>
                <div class="col-md-3" style="padding-left:10px;"><input type="text" style="width: 100%" autocomplete="off" placeholder="Họ và tên" name="hoten" /></div>
                <div class="col-md-1" style="padding-left: 10px; min-width: 120px;">Thư điện tử:</div>
                <div class="col-md-3" style="padding-left:10px;"><input type="text" style="width: 100%" autocomplete="off" placeholder="Địa chỉ mail" name="thudientu" /></div>
            </div>
            
            <div class="row" style="width:100%">
 
                <div class="col-md-1" style="padding-left: 10px; min-width: 120px;">Chức vụ:</div>
                <div class="col-md-3" style="padding-left:10px;">
                    <select id="filter03" data-placeholder="Chức vụ" class="chosen-select-chucdanhnew" name="machucdanh">
                        <option value="0">Chọn chức vụ</option>
                        @foreach (var item in Model.ChucDanhs)
                        {
                            <option value="@item.machucdanh">@item.tenchucdanh</option>
                        }
                    </select>
                </div>

                <div class="col-md-1" style="padding-left: 10px; min-width: 120px;">Phòng ban:</div>
                <div class="col-md-3" style="padding-left:10px;">
                    <select id="filter04" data-placeholder="Chọn phòng ban..." class="chosen-select-phongbannew" name="maphongban">
                        <option value="">Chọn phòng ban</option>
                        @foreach (var item in Model.PhongBans)
                        {
                            <option value="@item.maphongban">@item.tenphongban</option>
                        }
                    </select>
                </div>

            </div>

            <div class="row" style="width:100%">

                <div class="col-md-1" style="padding-left: 10px; min-width: 120px;">Công trường:</div>
                <div class="col-md-3" style="padding-left:10px;">
                    <select id="filter06" data-placeholder="Công trường ..." class="chosen-select-chucdanhnew" name="macongtruong">
                        <option value="">Chọn công trường</option>
                        @foreach (var item in Model.CongTruongs)
                        {
                            <option value="@item.maphongban">@item.tenphongban</option>
                        }
                    </select>
                </div>

                <div class="col-md-1" style="padding-left: 10px; min-width: 120px;">Loại báo cáo:</div>
                <div class="col-md-3" style="padding-left:10px;">
                    <select id="filter07" data-placeholder="Chọn loại báo cáo..." class="chosen-select-phongbannew" name="loaicuochop">
                                <option value="6">Chọn loại báo cáo tuần</option>
                                <option value="1">Báo cáo tuần CHT/TPB</option>
                                <option value="2">Báo cáo tuần Thiết Bị</option>
                                <option value="3">Báo cáo tuần HSSE</option>
                                <option value="4">Báo cáo tuần QAQC</option>
                                <option value="5">Báo cáo tuần MEP</option>
                    </select>
                </div>

            </div>
             <div class="row" style="width:100%">

                 <div class="col-md-1" style="padding-left: 10px; min-width: 120px;">Đơn vị:</div>
                 <div class="col-md-3" style="padding-left:10px;">
                     <select id="filter05" data-placeholder="Chọn đơn vị..." class="chosen-select-donvinew" name="madonvi">
                         @foreach (var item in Model.DonVis)
                         {
                             <option value="@item.madonvi">@item.tendonvi</option>
                         }
                     </select>
                 </div>

                 <div class="col-md-1" style="padding-left: 10px; min-width: 120px;">Trạng thái:</div>
                 <div class="col-md-3" style="padding-left:10px;"><label><input type="checkbox" id="chkSelectKichhoat" checked="checked" /><span id="spKichhoat">Kích hoạt</span></label></div>
            </div>
            
            <div class="row" style="width:100%">
                <div class="col-md-1" style="padding-left: 10px; min-width: 120px;"></div>
                <div class="col-md-8" style="padding-left:10px;">
                    <input type="button" id="btn-create" class="buttoncustom WhiteButton" name="New" value="Thêm mới" />
                    <input type="button" id="btn-edit" class="buttoncustom WhiteButton" name="Update" value="Hiệu chỉnh" />
                    <input type="button" id="btn-save" class="buttoncustom WhiteButton" name="luu" value="Lưu" />
                </div>

            </div>


            @*<table>

                <tr>
                    <td style="padding-top:50px;"></td>
                    <td>
                       
                        <input type="button" id="btn-create" class="buttoncustom WhiteButton" name="New" value="Thêm mới" />
                        <input type="button" id="btn-edit" class="buttoncustom WhiteButton" name="Update" value="Hiệu chỉnh" />
                        <input type="button" id="btn-save" class="buttoncustom WhiteButton" name="luu" value="Lưu" />

                        
                    </td>
                </tr>

            </table>*@
        }
    </div>
</div>

<div style="width:100%; height:75%;">
    <div id="boxContent">
        <div class="row">
            <div class="col-md-12">
                <div class="portlet-body">
                    <div class="table-responsive">
                        <table class="table table-bordered table_danhSach" id="tableContent">
                            <thead>
                            </thead>
                            <tbody></tbody>
                            <tfoot>
                                <tr>
                                    <td colspan="12" id="girdInfo">Tổng số: @*<span class="currentRow">0</span>/*@<span class="sumRow">0</span></td>
                                </tr>
                                <tr>
                                    <td colspan="12" id="girdInfoLoad">
                                        <div class="divExentd"><i class="retweet_32"></i>Xem thêm</div>
                                    </td>
                                </tr>
                                @*<tr>
                                        <td colspan="16" id="footerInfo">
                                            <div class="companyName">Ricons Construction Investment JSC</div>
                                            <div class="address">236/6 Dien Bien Phu, Ward 17, Binh Thanh Dist., HCMC, Vietnam</div>
                                        </td>
                                    </tr>*@
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>


@*<div id="boxContent">
    <div class="boxTable boxTable1">
        <table class="table_danhSach table_fixed" id="tableFixedHeader"></table>
    </div>
    <div class="boxTable boxTable2">
        <table class="table_danhSach table_fixed" id="tableContent">
            <thead>

            </thead>
            <tbody></tbody>
            <tfoot>
                <tr>
                    <td colspan="9" id="girdInfo">Tổng số: <span class="currentRow">1</span>/<span class="sumRow">212</span></td>
                </tr>
                <tr>
                    <td colspan="10" id="girdInfoLoad">
                        <div class="divExentd"><i class="retweet_32"></i>Xem thêm</div>
                    </td>
                </tr>
                <tr>
                    <td colspan="10" id="footerInfo">
                        <div class="companyName">CÔNG TY CỔ PHẦN RICONS</div>
                        <div class="address">ĐIỆN BIÊN PHỦ</div>
                    </td>
                </tr>
            </tfoot>
        </table>
    </div>
</div>*@


<script>
    $(document).ready(function () {
        $('#btn-create').on('click', function (e) {
            var form = $(this).closest('form');
            form.find('input[name="act"]').val('create');
            form.find('input[name="mataikhoan"]').val('');
            //alert('Xoá trắng dữ liệu để thêm mới tk');
            form[0].reset();
        });

        $('#btn-save').on('click', function (e) {
            var form = $('#frm-create > form'); //sau viet kieu nay
            form.submit();
        });

        $('#content').on('click','a.edit',function (e) {
            e.preventDefault();
            // Bo check tat ca 
            $('#tableContent input[type="checkbox"]').prop('checked', false);
            // check dong dang chon
            $(this).closest('tr').find('input[type="checkbox"]').prop('checked', true);
            // Goi nut edit click
            $('#btn-edit').trigger('click');
        });

        $('#content').on('click', 'a.del', function (e) {
            e.preventDefault();
            // Bo check tat ca 
            $('#tableContent input[type="checkbox"]').prop('checked', false);
            // check dong dang chon
            $(this).closest('tr').find('input[type="checkbox"]').prop('checked', true);
            // Goi nut edit click
            var form = $('#frm-create > form');
            var check = $('.chkCheck:checked');
            form.find('input[name="act"]').val('del');

            var mataikhoan = $(check[0]).attr('codeid');

            form.find('input[name="mataikhoan"]').val(mataikhoan);

            $('#btn-save').trigger('click');
        });



        $('#btn-edit').on('click', function (e) {
            var form = $('#frm-create > form'); // lay form
            var check = $('.chkCheck:checked');
            if (check.length <= 0) {
                alert('chon dong de hieu chinh')
                //ShowMessageBox("Vui lòng check dòng muốn hiệu chỉnh", "Hiệu chỉnh tài khoản", "okcancel", "question");
                return false;
            }
            else {
                var mataikhoan = $(check[0]).attr('codeid');
                var row = $(check[0]).closest('tr.rows-box');
                var maphongban = $(row).find('.col7').attr('title');
                var machucdanh = $(row).find('.col8').attr('title');
                var madonvi = $(row).find('.col9').attr('title');
                var macongtruong = $(row).find('.col11').attr('title');
                var loaibaocao = $(row).find('.col12').attr('title');

                form.find('input[name="act"]').val('update');
                form.find('input[name="mataikhoan"]').val(mataikhoan);

                form.find('input[name="tendangnhap"]').val(row.find('.col4').text());
                form.find('input[name="hoten"]').val(row.find('.col5').text());
                form.find('input[name="thudientu"]').val(row.find('.col6').text());
                form.find('input[name="tenphongban"]').val(row.find('.col7').text());
                form.find('input[name="tenchucdanh"]').val(row.find('.col8').text());              
                form.find('input[name="tendonvi"]').val(row.find('.col9').text());
                //form.find('input[name="tencongtruong"]').val(row.find('.col11').text());
                //form.find('input[name="loaibaocao"]').val(row.find('.col12').text());

                $('#filter03').val(machucdanh);
                $('#filter04').val(maphongban);
                $('#filter05').val(madonvi);
                $('#filter06').val(macongtruong);
                $('#filter07').val(loaibaocao);
                for (var selector in configChosenMilestones) {
                    $(selector).change();
                    $(selector).trigger('chosen:updated');
                }
                if ($(row).find('.col3').attr('title') == "1") {
                    $('#spKichhoat').html("Kích hoạt");
                    $("#spKichhoat").prop('checked', true);
                    //document.getElementById("myCheck").checked = false;
                }

                else {
                    $('#spKichhoat').html("Không kích hoạt");
                    $("#spKichhoat").prop('checked', false);
                }
            }
        });

    })
</script>